name: update-with-spacefinder-data
on: workflow_dispatch
jobs:
  keep_file_updated:
    runs-on: ubuntu-latest
    name: Keep file updated
    steps:
    - name: Checkout repo
      id: checkout
      uses: actions/checkout@v3
    - name: Update file
      id: update_file
      uses: TheLastProject/keep-remote-file-locally-up-to-date-action@v1
      with:
        url: https://spacefinder.leeds.ac.uk/spaces.json
        file_in_repo: _data/spaces.json
    - name: Setup Node
      uses: actions/setup-node@v3
      with:
        node-version: '16'
    - name: Update and commit
      run: | 
        cd main
        npm run build
        git config --global user.name 'peteredwards'
        git config --global user.email 'p.l.edwards@leeds.ac.uk'
        git add --all
        git diff-index --quiet HEAD || (git commit -am "[bot] Content updated with spacefinder data" && git push)